' Gambas class file

Private sQry As String
Private cx As New Connection
Private rs As Result
Private s As TextArea
Private GridCom As GridView
Private GridInd As GridView
Private GridCont As GridView

Public Sub Leer()
  
  Dim i As Integer
  Dim iCor As Integer
  Dim iRndColor As Integer
  Dim iFont As Integer = 10
  
  cx = M_DB.Connect()
  sQry = ("SELECT tbl_programa.idtbl_programa, tbl_programa.descripcion, tbl_actividad.contenido, tbl_actividad.competencia_grado ,tbl_actividad.indicador_logro  FROM tbl_programa, tbl_actividad WHERE tbl_programa.idtbl_programa = tbl_actividad.id_programa AND tbl_programa.descripcion LIKE '" & txtnameapp.Text & "'") 
  rs = cx.Exec(sQry)
  
  GridCom = New GridView(ScrollCompetencia) As "GridCom"
  GridInd = New GridView(ScrollIndicador) As "GridCont"
  GridCont = New GridView(ScrollContenido) As "GridCont"
  
  ''COMPETENCIA
  
  GridCom.Expand = True 
  GridCom.Grid = False
  GridCom.Header = GridView.None 'GridView.Both
  
  GridCom.Columns.Count = 4
  GridCom.Rows.Height = 60
  GridCom.Mode = Select.Single
  GridCom.ScrollBar = True
  ' Grid.Sorted = True
  ' Grid.Columns.Ascending = True
  GridCom.Columns[0].Text = ("Logo")
  GridCom.Columns[1].Text = ("Programa")
  GridCom.Columns[2].Text = ("Competencia")
  GridCom.columns[0].width = 0
  GridCom.columns[1].width = 0
  
  GridCom.Columns[0].Alignment = Align.Center
  ' Grid.columns[1].width = 150
  GridCom.Columns[2].Expand = True
  GridCom.Columns[2].Alignment = Align.Justify
  'Grid.Columns[2].Alignment = True
  
  GridCom.columns[3].width = 0
  
  ' Grid.Rows.Border.BackslashStyle = 1
  'Grid.Foreground = &00142B3F& 
  GridCom.Rows.Count = rs.Count 
  
  ''INDICADORES
  
  GridInd.Expand = True 
  GridInd.Grid = False
  GridInd.Header = GridView.None 'GridView.Both
  GridInd.Columns.Count = 4
  GridInd.Rows.Height = 60
  GridInd.Mode = Select.Single
  GridInd.ScrollBar = True
  GridInd.Columns[0].Text = ("Logo")
  GridInd.Columns[1].Text = ("Programa")
  GridInd.Columns[2].Text = ("Indicadores")
  GridInd.columns[0].width = 0
  GridInd.columns[1].width = 0
  GridInd.Columns[0].Alignment = Align.Center
  GridInd.Columns[2].Expand = True
  GridInd.Columns[2].Alignment = Align.Justify
  GridInd.columns[3].width = 0
  GridInd.Rows.Count = rs.Count 
  
  ''CONTENIDO
  
  GridCont.Expand = True 
  GridCont.Grid = False
  GridCont.Header = GridView.None 'GridView.Both
  GridCont.Columns.Count = 4
  GridCont.Rows.Height = 60
  GridCont.Mode = Select.Single
  GridCont.ScrollBar = True
  GridCont.Columns[0].Text = ("Logo")
  GridCont.Columns[1].Text = ("Programa")
  GridCont.Columns[2].Text = ("Contenido")
  GridCont.columns[0].width = 0
  GridCont.columns[1].width = 0
  GridCont.Columns[0].Alignment = Align.Center
  GridCont.Columns[2].Expand = True
  GridCont.Columns[2].Alignment = Align.Justify
  GridCont.columns[3].width = 0
  GridCont.Rows.Count = rs.Count 
  
  Randomize
  
  For i = 0 To rs.Count - 1
    iRndColor = Rand(&00836780, &00fae693)
    Inc iCor
    
    GridCom[i, 0].Picture = Pic_Logo_PreviewApp.Picture.Image.Stretch(48, 48).Picture
    GridCom[i, 1].RichText = rs!descripcion
    GridCom[i, 2].RichText = iCor & " - " & rs!competencia_grado
    GridCom[i, 2].WordWrap = True
    GridCom[i, 2].Background = iRndColor
    GridCom[i, 2].Font.Size = iFont
    
    GridInd[i, 0].Picture = Pic_Logo_PreviewApp.Picture.Image.Stretch(48, 48).Picture
    GridInd[i, 1].RichText = rs!descripcion
    GridInd[i, 2].RichText = iCor & " - " & rs!indicador_logro
    GridInd[i, 2].WordWrap = True
    GridInd[i, 2].Background = iRndColor
    GridInd[i, 2].Font.Size = iFont
    
    GridCont[i, 0].Picture = Pic_Logo_PreviewApp.Picture.Image.Stretch(48, 48).Picture
    GridCont[i, 1].RichText = rs!descripcion
    GridCont[i, 2].RichText = iCor & " - " & rs!contenido
    GridCont[i, 2].WordWrap = True
    GridCont[i, 2].Background = iRndColor
    GridCont[i, 2].Font.Size = iFont
    
    ' Grid[i, 2].RichText = "<b><u><font color=#005FBF>" & rs!competencia_grado & "</font></u></b>"
    '  Grid[i, 2].RichText &= "<br><font size=-1>" & rs!competencia_grado & " Downloads" & "</font>"
    rs.MoveNext
    
  Next
  
End

Public Sub Leer001()
  
  Dim i As Integer
  Dim iCor As Integer
  Dim iRndColor As Integer
  Dim iFont As Integer = 20
  ' PictureBox1.w = 56 
  ' PictureBox1.h = 56 
  ' PictureBox1.Border = Border.Dashed
  ' PictureBox1.Stretch = True
  ' PictureBox1.Mouse = 13
  'PictureBox1.y = 2
  cx = M_DB.Connect()
  sQry = ("SELECT tbl_programa.idtbl_programa, tbl_programa.descripcion, tbl_actividad.contenido, tbl_actividad.competencia_grado ,tbl_actividad.indicador_logro  FROM tbl_programa, tbl_actividad WHERE tbl_programa.idtbl_programa = tbl_actividad.id_programa AND tbl_programa.descripcion LIKE '" & txtnameapp.Text & "'") 
  rs = cx.Exec(sQry)
  
  Randomize
  
  For i = 0 To rs.Count - 1
    iRndColor = Rand(&00836780, &00fae693)
    Inc iCor
    
    s = New TextArea(ScrollCompetencia) As "Competencia"
    s.Expand = True
    s.AutoResize = True
    s.Alignment = Align.Left
    s.w = 500
    s.h = 49     
    s.Border = Border.Plain    
    s.text = iCor & " - " & rs!competencia_grado 
    s.Mouse = 13
    s.Foreground = Color.Black
    s.Background = iRndColor
    's.Padding = 5
    s.Font.Size = iFont
    s.Tag = s
    
    ' Randomize
    'Dice = Rand(&00FFD700, &00FF0000)
    
    s = New TextArea(ScrollIndicador) As "Indicador"
    s.Expand = True
    s.Alignment = Align.Left
    s.w = 500
    s.h = 49     
    s.Border = Border.Plain    
    s.text = iCor & " - " & rs!indicador_logro 
    s.Mouse = 13
    s.Foreground = Color.Black
    s.Background = iRndColor
    s.Font.Size = iFont
    s.Tag = s
    
    s = New TextArea(ScrollContenido) As "Contenido"
    s.Expand = True
    s.Alignment = Align.Left
    s.w = 500
    s.h = 49     
    s.Border = Border.Plain    
    s.text = iCor & " - " & rs!contenido 
    s.Mouse = 13
    s.Foreground = Color.Black
    s.Background = iRndColor
    s.Font.Size = iFont
    s.Tag = s
    
    rs.MoveNext
  Next
  
End

Public Sub PictureBox1_Leave()
  
  ' PictureBox1.Border = Border.Dashed
  ' PictureBox1.w = 56 - 12
  ' PictureBox1.h = 56 - 12
  
End

Public Sub Form_Open()
  
  TBCNB.Background = Color.Transparent
  Leer
  Wait 0.5
  
End

Public Sub Grid_Data(Row As Integer, Column As Integer)
  
End

Public Sub Grid_Click()
  
  ' Message(Grid[Grid.Row, 1].Text)
  ' Print Grid[2, 2].text 
  ' If Grid[Grid.row, 1].text Then
  '  Message("")
  ' Endif
  
End

Public Sub PanelLauncher_Draw()
  
End

Public Sub PanelApp_MouseDown()

  

End
